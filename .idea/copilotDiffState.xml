<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/src/main/java/edu/library/Calculator.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/edu/library/Calculator.java" />
              <option name="originalContent" value="package edu.library;&#10;&#10;public class Calculator {&#10;    public int add(int a, int b) {&#10;        return a + b;&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package edu.library;&#10;&#10;public class Calculator {&#10;    public int add(int a, int b) {&#10;        return a + b;&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/edu/library/Main.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/edu/library/Main.java" />
              <option name="originalContent" value="package edu.library;&#10;&#10;import edu.library.model.Book;&#10;import edu.library.service.BookService;&#10;import edu.library.model.Roles;&#10;import edu.library.service.AuthService;&#10;import edu.library.service.Admin;&#10;import edu.library.service.Member;&#10;import edu.library.service.Librarian;&#10;import java.util.Scanner;&#10;&#10;&#10;public class Main {&#10;    public static void main(String[] args) {&#10;        BookService service = new BookService();&#10;        service.loadBooksFromFile();&#10;        AuthService auth = new AuthService();&#10;        Scanner input = new Scanner(System.in);&#10;&#10;        while (true) {&#10;            System.out.println(&quot;\n=== Welcome to the Library System ===&quot;);&#10;            System.out.println(&quot;1. Sign up&quot;);&#10;            System.out.println(&quot;2. Login&quot;);&#10;            System.out.println(&quot;3. Exit&quot;);&#10;            System.out.print(&quot;Choose option: &quot;);&#10;            String line = input.nextLine();&#10;            int choice;&#10;            try {&#10;                choice = Integer.parseInt(line.trim());&#10;            } catch (Exception e) {&#10;                System.out.println(&quot;Invalid input&quot;);&#10;                continue;&#10;            }&#10;&#10;            if (choice == 1) {&#10;                String email;&#10;                while (true) {&#10;                    System.out.print(&quot;Enter email (required): &quot;);&#10;                    email = input.nextLine().trim();&#10;                    if (email.isEmpty()) {&#10;                        System.out.println(&quot;Email is required and cannot be empty.&quot;);&#10;                        continue;&#10;                    }&#10;                    break;&#10;                }&#10;&#10;                System.out.print(&quot;Enter username: &quot;);&#10;                String username = input.nextLine().trim();&#10;                System.out.print(&quot;Enter password: &quot;);&#10;                String password = input.nextLine().trim();&#10;                // Registration always creates a MEMBER by default&#10;                String role = &quot;MEMBER&quot;;&#10;&#10;                // check if username exists&#10;                boolean exists = false;&#10;                for (Roles r : auth.getUsers()) {&#10;                    if (r.getUsername().equalsIgnoreCase(username)) {&#10;                        exists = true;&#10;                        break;&#10;                    }&#10;                }&#10;                if (exists) {&#10;                    System.out.println(&quot;Username already exists. Choose another.&quot;);&#10;                } else {&#10;                    auth.addUser(username, password, role, email);&#10;                    System.out.println(&quot;Registration successful. You can now login (role: MEMBER).&quot;);&#10;                }&#10;                continue;&#10;            }&#10;&#10;            if (choice == 2) {&#10;                System.out.print(&quot;Enter username: &quot;);&#10;                String username = input.nextLine();&#10;                System.out.print(&quot;Enter password: &quot;);&#10;                String password = input.nextLine();&#10;                Roles user = auth.login(username, password);&#10;                if (user == null) {&#10;                    System.out.println(&quot;❌ Invalid credentials.&quot;);&#10;                    continue;&#10;                }&#10;&#10;                System.out.println(&quot;✅ Logged in as: &quot; + user.getUsername() + &quot; (&quot; + user.getRoleName() + &quot;)&quot;);&#10;&#10;                // role-based menu loop&#10;                boolean sessionActive = true;&#10;                while (sessionActive) {&#10;                    int result;&#10;                    if (user.isAdmin()) {&#10;                        result = Admin.handle(input, service, auth, user);&#10;                    } else if (user.isMember()) {&#10;                        result = Member.handle(input, service, auth, user);&#10;                    } else if (user.isLibrarian()) {&#10;                        result = Librarian.handle(input, service, auth, user);&#10;                    } else {&#10;                        // unknown role: fallback to member behavior&#10;                        result = Member.handle(input, service, auth, user);&#10;                    }&#10;&#10;                    if (result == 1) { // logout&#10;                        sessionActive = false;&#10;                    } else if (result == 2) { // exit app&#10;                        System.out.println(&quot; Exiting...&quot;);&#10;                        return;&#10;                    }&#10;                }&#10;            }&#10;&#10;            if (choice == 3) {&#10;                System.out.println(&quot; Exiting...&quot;);&#10;                return;&#10;            }&#10;        }&#10;    }&#10;&#10;    private static Book findBookByIsbn(BookService service, String isbn) {&#10;        if (isbn == null) return null;&#10;        for (Book b : service.getBooks()) {&#10;            if (isbn.equalsIgnoreCase(b.getIsbn())) return b;&#10;        }&#10;        return null;&#10;    }&#10;&#10;&#10;}" />
              <option name="updatedContent" value="package edu.library;&#10;&#10;import edu.library.model.Book;&#10;import edu.library.service.BookService;&#10;import edu.library.model.Roles;&#10;import edu.library.service.AuthService;&#10;import edu.library.service.Admin;&#10;import edu.library.service.Member;&#10;import edu.library.service.Librarian;&#10;import java.util.Scanner;&#10;&#10;&#10;public class Main {&#10;    public static void main(String[] args) {&#10;        BookService service = new BookService();&#10;        service.loadBooksFromFile();&#10;        AuthService auth = new AuthService();&#10;        Scanner input = new Scanner(System.in);&#10;&#10;        while (true) {&#10;            System.out.println(&quot;\n=== Welcome to the Library System ===&quot;);&#10;            System.out.println(&quot;1. Sign up&quot;);&#10;            System.out.println(&quot;2. Login&quot;);&#10;            System.out.println(&quot;3. Exit&quot;);&#10;            System.out.print(&quot;Choose option: &quot;);&#10;            String line = input.nextLine();&#10;            int choice;&#10;            try {&#10;                choice = Integer.parseInt(line.trim());&#10;            } catch (Exception e) {&#10;                System.out.println(&quot;Invalid input&quot;);&#10;                continue;&#10;            }&#10;&#10;            if (choice == 1) {&#10;                String email;&#10;                while (true) {&#10;                    System.out.print(&quot;Enter email (required): &quot;);&#10;                    email = input.nextLine().trim();&#10;                    if (email.isEmpty()) {&#10;                        System.out.println(&quot;Email is required and cannot be empty.&quot;);&#10;                        continue;&#10;                    }&#10;                    break;&#10;                }&#10;&#10;                System.out.print(&quot;Enter username: &quot;);&#10;                String username = input.nextLine().trim();&#10;                System.out.print(&quot;Enter password: &quot;);&#10;                String password = input.nextLine().trim();&#10;                // Registration always creates a MEMBER by default&#10;                String role = &quot;MEMBER&quot;;&#10;&#10;                // check if username exists&#10;                boolean exists = false;&#10;                for (Roles r : auth.getUsers()) {&#10;                    if (r.getUsername().equalsIgnoreCase(username)) {&#10;                        exists = true;&#10;                        break;&#10;                    }&#10;                }&#10;                if (exists) {&#10;                    System.out.println(&quot;Username already exists. Choose another.&quot;);&#10;                } else {&#10;                    auth.addUser(username, password, role, email);&#10;                    System.out.println(&quot;Registration successful. You can now login (role: MEMBER).&quot;);&#10;                }&#10;                continue;&#10;            }&#10;&#10;            if (choice == 2) {&#10;                System.out.print(&quot;Enter username: &quot;);&#10;                String username = input.nextLine();&#10;                System.out.print(&quot;Enter password: &quot;);&#10;                String password = input.nextLine();&#10;                Roles user = auth.login(username, password);&#10;                if (user == null) {&#10;                    System.out.println(&quot;❌ Invalid credentials.&quot;);&#10;                    continue;&#10;                }&#10;&#10;                System.out.println(&quot;✅ Logged in as: &quot; + user.getUsername() + &quot; (&quot; + user.getRoleName() + &quot;)&quot;);&#10;&#10;                // role-based menu loop&#10;                boolean sessionActive = true;&#10;                while (sessionActive) {&#10;                    int result;&#10;                    if (user.isAdmin()) {&#10;                        result = Admin.handle(input, service, auth, user);&#10;                    } else if (user.isMember()) {&#10;                        result = Member.handle(input, service, auth, user);&#10;                    } else if (user.isLibrarian()) {&#10;                        result = Librarian.handle(input, service, auth, user);&#10;                    } else {&#10;                        // unknown role: fallback to member behavior&#10;                        result = Member.handle(input, service, auth, user);&#10;                    }&#10;&#10;                    if (result == 1) { // logout&#10;                        sessionActive = false;&#10;                    } else if (result == 2) { // exit app&#10;                        System.out.println(&quot; Exiting...&quot;);&#10;                        return;&#10;                    }&#10;                }&#10;            }&#10;&#10;            if (choice == 3) {&#10;                System.out.println(&quot; Exiting...&quot;);&#10;                return;&#10;            }&#10;        }&#10;    }&#10;&#10;    private static Book findBookByIsbn(BookService service, String isbn) {&#10;        if (isbn == null) return null;&#10;        for (Book b : service.getBooks()) {&#10;            if (isbn.equalsIgnoreCase(b.getIsbn())) return b;&#10;        }&#10;        return null;&#10;    }&#10;&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/src/main/java/edu/library/service/Member.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/src/main/java/edu/library/service/Member.java" />
              <option name="originalContent" value="package edu.library.service;&#10;&#10;import edu.library.model.Book;&#10;import edu.library.model.Roles;&#10;&#10;import java.util.List;&#10;import java.util.Scanner;&#10;&#10;public class Member {&#10;    /**&#10;     * Handle member menu actions.&#10;     * return 0 = stay logged in, 1 = logout, 2 = exit app&#10;     */&#10;    public static int handle(Scanner input, BookService service, AuthService auth, Roles user) {&#10;        System.out.println(&quot;--- Member Session: &quot; + user.getUsername() + &quot; (&quot; + user.getRoleName() + &quot;) | &quot; + user.getEmail() + &quot; ---&quot;);&#10;        System.out.println(&quot;1. Search Book&quot;);&#10;        System.out.println(&quot;2. Borrow Book (by ISBN)&quot;);&#10;        System.out.println(&quot;3. Return Book (by ISBN)&quot;);&#10;        System.out.println(&quot;4. Display All Books&quot;);&#10;        System.out.println(&quot;5. Logout&quot;);&#10;        System.out.println(&quot;6. Exit&quot;);&#10;        System.out.print(&quot;Choose option: &quot;);&#10;&#10;        String opt = input.nextLine();&#10;        int optInt;&#10;        try {&#10;            optInt = Integer.parseInt(opt.trim());&#10;        } catch (Exception e) {&#10;            System.out.println(&quot;Invalid option&quot;);&#10;            return 0;&#10;        }&#10;&#10;        switch (optInt) {&#10;            case 1: {&#10;                System.out.print(&quot;Enter title/author/ISBN to search: &quot;);&#10;                String keyword = input.nextLine();&#10;                List&lt;Book&gt; foundBooks = service.searchBook(keyword);&#10;                if (foundBooks.isEmpty()) {&#10;                    System.out.println(&quot;❌ No matching books found!&quot;);&#10;                } else {&#10;                    System.out.println(&quot;✅ Found books:&quot;);&#10;                    for (Book b : foundBooks) System.out.println(b);&#10;                }&#10;                return 0;&#10;            }&#10;            case 2: {&#10;                System.out.print(&quot;Enter ISBN to borrow: &quot;);&#10;                String isbnBorrow = input.nextLine();&#10;                Book bookToBorrow = findBookByIsbn(service, isbnBorrow);&#10;                if (bookToBorrow == null) {&#10;                    System.out.println(&quot;Book not found.&quot;);&#10;                    return 0;&#10;                }&#10;                if (!bookToBorrow.isAvailable()) {&#10;                    System.out.println(&quot;Book is currently not available.&quot;);&#10;                    return 0;&#10;                }&#10;                System.out.print(&quot;For how many days? &quot;);&#10;                String daysStr = input.nextLine();&#10;                int days;&#10;                try {&#10;                    days = Integer.parseInt(daysStr.trim());&#10;                } catch (Exception e) {&#10;                    System.out.println(&quot;Invalid number&quot;);&#10;                    return 0;&#10;                }&#10;                if (service.borrowBook(bookToBorrow, days)) {&#10;                    System.out.println(&quot;Book borrowed successfully.&quot;);&#10;                } else {&#10;                    System.out.println(&quot;Could not borrow book.&quot;);&#10;                }&#10;                return 0;&#10;            }&#10;            case 3: {&#10;                System.out.print(&quot;Enter ISBN to return: &quot;);&#10;                String isbnReturn = input.nextLine();&#10;                Book bookToReturn = findBookByIsbn(service, isbnReturn);&#10;                if (bookToReturn == null) {&#10;                    System.out.println(&quot;Book not found.&quot;);&#10;                    return 0;&#10;                }&#10;                if (bookToReturn.isAvailable()) {&#10;                    System.out.println(&quot;This book is not borrowed.&quot;);&#10;                    return 0;&#10;                }&#10;                if (service.returnBook(bookToReturn)) {&#10;                    System.out.println(&quot;Book returned successfully.&quot;);&#10;                } else {&#10;                    System.out.println(&quot;Could not return book.&quot;);&#10;                }&#10;                return 0;&#10;            }&#10;            case 4: {&#10;                service.displayBooks();&#10;                return 0;&#10;            }&#10;            case 5: {&#10;                if (auth.logout()) {&#10;                    System.out.println(&quot;✅ Logged out successfully.&quot;);&#10;                    return 1;&#10;                } else {&#10;                    System.out.println(&quot;⚠️ No user is currently logged in.&quot;);&#10;                    return 0;&#10;                }&#10;            }&#10;            case 6: {&#10;                System.out.println(&quot; Exiting...&quot;);&#10;                return 2;&#10;            }&#10;            default: {&#10;                System.out.println(&quot;❌ Invalid option. Try again.&quot;);&#10;                return 0;&#10;            }&#10;        }&#10;    }&#10;&#10;    private static Book findBookByIsbn(BookService service, String isbn) {&#10;        if (isbn == null) return null;&#10;        for (Book b : service.getBooks()) {&#10;            if (isbn.equalsIgnoreCase(b.getIsbn())) return b;&#10;        }&#10;        return null;&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package edu.library.service;&#10;&#10;import edu.library.model.Book;&#10;import edu.library.model.Roles;&#10;&#10;import java.util.List;&#10;import java.util.Scanner;&#10;&#10;public class Member {&#10;    /**&#10;     * Handle member menu actions.&#10;     * return 0 = stay logged in, 1 = logout, 2 = exit app&#10;     */&#10;    public static int handle(Scanner input, BookService service, AuthService auth, Roles user) {&#10;        System.out.println(&quot;--- Member Session: &quot; + user.getUsername() + &quot; (&quot; + user.getRoleName() + &quot;) | &quot; + user.getEmail() + &quot; ---&quot;);&#10;        System.out.println(&quot;1. Search Book&quot;);&#10;        System.out.println(&quot;2. Borrow Book (by ISBN)&quot;);&#10;        System.out.println(&quot;3. Return Book (by ISBN)&quot;);&#10;        System.out.println(&quot;4. Display All Books&quot;);&#10;        System.out.println(&quot;5. Logout&quot;);&#10;        System.out.println(&quot;6. Exit&quot;);&#10;        System.out.print(&quot;Choose option: &quot;);&#10;&#10;        String opt = input.nextLine();&#10;        int optInt;&#10;        try {&#10;            optInt = Integer.parseInt(opt.trim());&#10;        } catch (Exception e) {&#10;            System.out.println(&quot;Invalid option&quot;);&#10;            return 0;&#10;        }&#10;&#10;        switch (optInt) {&#10;            case 1: {&#10;                System.out.print(&quot;Enter title/author/ISBN to search: &quot;);&#10;                String keyword = input.nextLine();&#10;                List&lt;Book&gt; foundBooks = service.searchBook(keyword);&#10;                if (foundBooks.isEmpty()) {&#10;                    System.out.println(&quot;❌ No matching books found!&quot;);&#10;                } else {&#10;                    System.out.println(&quot;✅ Found books:&quot;);&#10;                    for (Book b : foundBooks) System.out.println(b);&#10;                }&#10;                return 0;&#10;            }&#10;            case 2: {&#10;                System.out.print(&quot;Enter ISBN to borrow: &quot;);&#10;                String isbnBorrow = input.nextLine();&#10;                Book bookToBorrow = findBookByIsbn(service, isbnBorrow);&#10;                if (bookToBorrow == null) {&#10;                    System.out.println(&quot;Book not found.&quot;);&#10;                    return 0;&#10;                }&#10;                if (!bookToBorrow.isAvailable()) {&#10;                    System.out.println(&quot;Book is currently not available.&quot;);&#10;                    return 0;&#10;                }&#10;                System.out.print(&quot;For how many days? &quot;);&#10;                String daysStr = input.nextLine();&#10;                int days;&#10;                try {&#10;                    days = Integer.parseInt(daysStr.trim());&#10;                } catch (Exception e) {&#10;                    System.out.println(&quot;Invalid number&quot;);&#10;                    return 0;&#10;                }&#10;                if (service.borrowBook(bookToBorrow, days)) {&#10;                    System.out.println(&quot;Book borrowed successfully.&quot;);&#10;                } else {&#10;                    System.out.println(&quot;Could not borrow book.&quot;);&#10;                }&#10;                return 0;&#10;            }&#10;            case 3: {&#10;                System.out.print(&quot;Enter ISBN to return: &quot;);&#10;                String isbnReturn = input.nextLine();&#10;                Book bookToReturn = findBookByIsbn(service, isbnReturn);&#10;                if (bookToReturn == null) {&#10;                    System.out.println(&quot;Book not found.&quot;);&#10;                    return 0;&#10;                }&#10;                if (bookToReturn.isAvailable()) {&#10;                    System.out.println(&quot;This book is not borrowed.&quot;);&#10;                    return 0;&#10;                }&#10;                if (service.returnBook(bookToReturn)) {&#10;                    System.out.println(&quot;Book returned successfully.&quot;);&#10;                } else {&#10;                    System.out.println(&quot;Could not return book.&quot;);&#10;                }&#10;                return 0;&#10;            }&#10;            case 4: {&#10;                service.displayBooks();&#10;                return 0;&#10;            }&#10;            case 5: {&#10;                if (auth.logout()) {&#10;                    System.out.println(&quot;✅ Logged out successfully.&quot;);&#10;                    return 1;&#10;                } else {&#10;                    System.out.println(&quot;⚠️ No user is currently logged in.&quot;);&#10;                    return 0;&#10;                }&#10;            }&#10;            case 6: {&#10;                System.out.println(&quot; Exiting...&quot;);&#10;                return 2;&#10;            }&#10;            default: {&#10;                System.out.println(&quot;❌ Invalid option. Try again.&quot;);&#10;                return 0;&#10;            }&#10;        }&#10;    }&#10;&#10;    private static Book findBookByIsbn(BookService service, String isbn) {&#10;        if (isbn == null) return null;&#10;        for (Book b : service.getBooks()) {&#10;            if (isbn.equalsIgnoreCase(b.getIsbn())) return b;&#10;        }&#10;        return null;&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>